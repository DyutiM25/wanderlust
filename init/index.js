require("dotenv").config();
const mongoose = require("mongoose");
const initData = require("./data.js");
const Listing = require("../models/listing.js");
const User = require("../models/user.js");

// Direct MongoDB Atlas URL (you can switch back to process.env.ATLASDB_URL if needed)
const dbUrl = "mongodb+srv://mengjidyuti:wPjlz5FeCV8sq9Cb@cluster0.8anvcei.mongodb.net/?retryWrites=true&w=majority&appName=Cluster0";

main()
  .then(() => console.log("connected to DB"))
  .catch((err) => console.log(err));

async function main() {
  await mongoose.connect(dbUrl);
}

const userData = [
  {
    _id: ObjectId('684547b70c05c4e6964c59e6'),
    email: 'student@gmail.com',
    username: 'delta-student',
    salt: '56f6803fa3d019d39ae95b41dce05345c86480a2620435df48805643652bbcc3',
    hash: '257624ef7e4181a5be61a62dd5891baacda6776e14b26ae9b046339f120228d771fb35d82cb69de98ea7aecf1bbac9b631b6429d84784c2ce59ff0d350fbc9c9f288de79257b3b1f34081895a55679be02004df0507fa3e9d6c942c7132d2d3cd51d00fbc5fc0d4e8eaf0c597bde3576e1fe921b8095aa766f2095075d6d360aadd52751dc9bc007812b49f374421d588be011a6f81b7eff95498e1dd5e643b9b4c6e01535246d93ef4d0c211e8d46d382963f562d066336c9774f57c7839189bf594d175b86233edf9d086fb82ae456996854200098b474e73784795eb25632d8c8583f625df7469cc7497b23e422f891dd179ec1efecd34937e5310a32dc1632a99b7c67c006be17658e503c9f2ea3d5346cdb8ec7851c9715d22115af41ffcceded342480aa22d141e78c3a450fa1ecb54bd4219a097a1f1118cbcb2d2e10fbf563c1a5d41ddfe5564fdf6372dd009dc0a349f324620aeb2dd6f5ff3f7dec7bd9766f1d20e3059c2c657d51344241a6ad3ac5382285c9084ee52da40ac87026fbcf09aa689a0f31919028c250bea51bc98023c963320f87e1bf562264579dc4de670462e89b2787981a74528053f076b014c0aa5b996409dffd1cd249fd677c016581363682b4e138709017e2875a375a1c8b1801398289394c92583b47df64bc4d2910db53cff18d9841d81d1d781f67c8d9fe0511a09157d4fe60c37feb',
    __v: 0
  },
  {
    _id: ObjectId('684580c5cc29a6383d40f5f4'),
    email: 'MENGJIDYUTI@GMAIL.COM',
    username: 'Dyuti Mengji',
    salt: '0c6152941bccf574d76af1533e845ed14ef4bd770c15ab8c98f9c5d42af66128',
    hash: 'fa6bf6074436a9a4713e5fb91110a5c7101605adee28580ec4e977277cc759a7c66b3bf1d61a08bb553a918d59d1a751f2c1ba2aded90a84636cfae2d991d55c5b74fbc620b9903e259c1959a5d6c1bcdf963fabbb53674ac0811d37ae175a9bbc036c7fbd858b4546c8221b6e901e1a1361989e9317214c9ebf663e67c6a415583601940b94343ecffe450706d503d6c5f8b2d2d5f52e040c880355c2743d51372c1454844f5d081acc52ee7409016ecef9e3796491b4b8d36a71854f7132968ea8ca6a58185199f83bbae9c2c5432f2193f4b43605e27416ab96204f04286a02a09eab09dbc75644bbf93374334aa2f829008b425ce12d1e85800329e084fa91ccb8a378a42bffd6b6fa92fedad710db359f04982420dbfc61da615070955904051436e032c4f6b29d6fe91a3a54744906e25e08a9b3f1ac8484c7c84d7815ea4fc8e227291dd541ee8fb91c01197e474ad2b816b172573892f329f334a0c7fe8648c6b01c4c30ab9982500fde8f0be8a6f8c8aa1aaeefe749ced7ba4510acfe31d916ccf61c3f2ab26772ae6f7544ae0534bf2fcec1c9cc6789e47eb35968db91ecd1f303bfd55e55869ee7866a86b0b7c74497cc68ae6d895813daf32861d645b047deb8e26f2bf36d8ff562e98a3d16394c46f1a59621709da52af9ca9755af77af3b958eaa6aece8937a17954aa7fb675a63cccc9f83289847f964288d',
    __v: 0
  },
  {
    _id: ObjectId('6845c550952860f2a8d4bee3'),
    email: 'Mengji@gmail.com',
    username: 'mengjidyuti',
    salt: '5620ed1bd9f89dc14172384780cc33aba62d38e5172de6ed6ce7374a2488151f',
    hash: '92c27dcd7d5967ea32333546c8875a300a1522e619f01cac89fb7470bb734f2bfacae593e19ce4acd125a9adf0f14d7ee64796acfaf2bdf239beccb51b308b5e3504a6a70e2ed7d8e2a27d74ca4daa5f75a98762e35661de771de32acac82834cc9f1521762164d5406e7252606672e0029ac78c13ce82d029e7e285efbf9429db33dc438b0d0297a8759fd24c91b06b3cc2b3f9a5310054cc506289cb4ac3fda08df04ce3d5fd0b47e52c7f4a92af2c1a0c82909c0095a2b2a19ec7e578674e3a1cf524f11541feb0b13e83ad2e147f1c992cb23ce049cff3f8d4680e74be16c864e88847ea40a4db223f673e5a22e03e03dcebba97fa5b38e2a58e0e10bf876f3fb16818be43df9a50f9b25784de960400746f8f4a70023063135fd8c49ff9bf7ce86199cb8952cca29072845593e622fa15dffca3a9e8fcde09503242d7ab72824f07b6857ec3f078bc0d3e4fa5a883a2bf0520e05eca582ffc655ef23052300ac32d911aca93526541ed4fdc4ec13d2327709d975eb7e1d7397a8218db47e431bfeacac67b637d506197975609e11d5b5bda8f34971e87e188ce9aaa3337ab2e5baf24bfba5b3957cf21fc3cdc02f34de3c045aa90bcce903eedce5efc26eaaeeea91884d2d7dee4e4bc4013f3c8b7cc9608500303b1bb6f4aaaa7d0e127766ca835b96f280e30bc94b97b056c255c0b1267dc73d2fd7ac767acaa54fd8f',
    __v: 0
  },
  {
    _id: ObjectId('6845ca17e9080895e851dcfa'),
    email: 'test@gmail.com',
    username: 'test',
    salt: '6cb95ea04a557da3338d388a28bb5b7927c55a6842f5ffc117297cdc56672d36',
    hash: '848b5e8074d2a0d1f1fabb4b24a0c402aed73033a4b7cbe00f37aa3cc854ccfbcbec2591ec7e2825d0eb5f31754a44b1c8305a2e9d5e3159b197f8a5b0820a50fa08ece1f70b721171a3f3452a8d3467c7c0cb020e20eba5c61981d2e21c464088a6bf7e64bc403f1f313460c7104d5bdf24ce58271e24c6786932303d8dd41f3c4161b74b09f9ad4ec34e55816ad395418b5cad251ee53ac34d24871365f35661248205156d1ce730a245a17baa0fa778bfe89cd6f6bc9b9b48b2ea857f2f63f70f2fc1612b88373b4fa985d5a387685ea7541fadd57fb44b6ff8b837922b9905e7e3d563e8f0e9c5804b9a0ca868b991ea496786bd078d64ec9306c1b0ec58488bbe00db50034dc3f5cba05996bd72b054b878870c51a8525fc8a47280dce0c6fcd875dc167eca715c11a4ad70f79b6eafc3e5f29f4ae2614e47c15ebc5e437b6741cdc6ee1d614223857e640b7f325c5d403a71c7b50b7221aa3132f34379e60f2de30d344844cc2a2678a0b7493985c4cbf947ffdc9fa01b6d53b949f2a584f3cf55cb6402c9f97aa7990fde0deaf2fce469aee30c9979a9756ee6e22702b822ecf2efaabac8ad1030507ea591c01478e172776da6fd3604269333e1e4b1626ab8fb9f83247c484a4b38a79fbec03975874a892ed71a820eb9409aad6bab8995a21e640ab0c0516957c3bf464da5927c821bb02c2c3102c6b244c3de7c84',
    __v: 0
  },
  {
    _id: ObjectId('6845d6bfaab22a8126986ecb'),
    email: 'demo@gmail.com',
    username: 'demo',
    salt: 'ccba0b904c357659b4c40b80a453db846d9261525b6dc64775a09d8c14e303be',
    hash: '58f1ba6cf9af002977f06e94662c5301cf18e6e9e6439d37aecdeadb11f3073f168891fa0c370fdf6646b5d1c6a464c03d093469e6dbe3ccf372bca694c6f65ba8c0453512bf995da5e30e4b444b0a0f2a3ac7951b6ba0279aee2b5f2b97a7daf1de7ddf49ca26d51a2328303966a447b95f34feb286870e9bb556e1f0a536782c7ca402d293a1098cf57752da8c6091f209e08c7ab26f8f2580cf0d5bf03ce2fd48116d5c5a639bd7c96704f836c1ea6c06caf8fa60e41fc03f3c18a0ebbc388f4a52a1118f290fb4826a9e4b632def21491a21f4f7ef218777d8a85c18c7e8e4686625f72a73ef4c035e1a06de05e1a2f3c6941c8eccb102735fb5a1bbd6b1cda2d9797510bdac8db829360a9fbc5ff7ec386f2c68920e4939fdd0868709e683cf07d3b62d90812cbe454a584ca75a8d334c2abda42d226a81b2f5df884c7b49af6445012a46ccebccee720bb5ec72d2c54dea1572d8edf9ad1582f151a1d88d253c40febe8660346ec171ac8aaf4ef2b60c3e7986fafb026bd5265473d475da5fa3f9643c480b1084320dc3cd8f2fe3e71fcb863a290e75bf72aca711eed8a94e739a5e784876ed43ec720fde418774c61df927b2a204819c6e7464cc95e534fd0a8dab5d14a1d4bee842c617f1a5f682dc69df5978e4c60fe7a5c778e5efb4fa3cb1aeb0c58b5ecec54f7e21b0a8b1698a7efbd4d13d383df164eff9b48e',
    __v: 0
  },
  {
    _id: ObjectId('68466e33327615918e38ff6e'),
    email: 'demo2@gmail.com',
    username: 'demo2',
    salt: 'b8d9afd27ded646e6cbcbb7c30563756bcbe816a7a0b750c703ae6ae90b88f74',
    hash: '91df7f85c229334614a05f67cff8689fd2e07846138f589a33aa63c6902f537cc226272b7be1583d747c08a425f24a5cf3a454ccc953bf80a2188a6f3d680c4b1f96bdaed203b897567bd16f3dde79f7ea7fa3ea7d0f91491e13dbb2e173ed83340898748620c7d7f622d2226b7c69fc379497ae5532a048b66ad7b90ed1f07a44c0b5ee4ec9498213becdab90dacbb677c5cc27f755c8084e2e1faefe59918d41572e0ef01a96a6824151811502e24508fb753836a11af7a7151f6a90224a60b0b0b96722664db005c33c87a2d3ceee27338324c849cb0d867a92624b833a0657aec273db2a0759df5d5f56cc93b8a25c8ad67bd60ec152e4cd9bfbf3f2223ce870269ad3076cd240525ca2fc916c070d1e7dc95906407cd0d0e37f24ec24bd026e84e44bdf52468f35e2fb8323900840ca38899104624af8a0b2862f8ea7f35b6f14ba92e3095141595b02e06f201a8f813be14b2f79a080dc419b05b9632d6965e0f3ee6dda310dc9d8577d9f19af91882079f32e3dcecda002c3cc6347725ffcd56adb45efedf4f42d7a6eabc0a2187f6d80ca7dbabd4122bd49361763009f070a0c350bb897ac3274c00bf2f6b0bc01d670cb4f3e11791e77be1c568d35e9330074c20de16450e41401985ff25e4d4fbed3e601c8066a89ca76142d1ce299b4ad0e69e5286f3f0b2a55e8edd27725cf4e6772508bf42130402787478a4a',
    __v: 0
  },
  {
    _id: ObjectId('6846ac2e6e585f847722f247'),
    email: 'random@gmail.com',
    username: 'random',
    salt: 'b2fa495858218841790a0be4f741ad18dbc582fe4838f64ca84c0268fba19c63',
    hash: '7554d0d332893213eec5b07918e214b6b5ec58bad3103e4cff69a3eeb5db77033524383bf06f9ffb51284d9008d344184971b366af9c4ad8361bd42be33134931eeb3155ad9b920f74728a796ac972c9c43c9d836c4edb37513645276e3bfe537947cdefd0f1a3d208c8b1e45d16501bd1fac75973ded75246c79cd122e8cf9a649a4701ccbdbab2e449839658bfa941cac4782ff8a9efb7c0edaa265d1d87f360b3098163bf3eb3fbb03d902d6adba9208d7c027f14f9d9149a10523cf0bf95322bb2ebe9dbd1010884937c1c89d5702fd4ff2c8bfb866eef83131cceb32728fc7c0ab6f743ca104655f5c20929775719d3112f9394577bb272dcb437fce908fe1b5930ca9a06c41d086d850fa87915690adfa222a6aa74cfeb78e9476a6a2ede3c393bd430bf0ef4e54b6422e4fd4fbea4542c87fe508a040335db0f309b80a19c941d07a22209c0e30d578b9d522131179ae3a62b5dac57b5b9d26ac4aeebce50500b2edc8420fea59a66c206bce04ebfa5dcc7ce2d8e85b05261edd2dceb6c0cb754be96e4bac0c7b8d880ce2fc8aacd081a9f8acf1903654b7a4a39894bddabe95fe20d07601dd2a2538cf951a63ef0db76885a71bd754dc938d0b91f96ccd08092e3630cd3cc39e360f0966da70e91d4dfce15e0d229ed9fd1788f2d6e40defd6a1156164a2301e65f1577198e2b79e40b5a697a349d82bf5d9b76eb43',
    __v: 0
  },
  {
    _id: ObjectId('6846af8a721a9166c352c71c'),
    email: 'test2@gmail.com',
    username: 'test2',
    salt: 'acab967a5c6a6b03de43b1c839593b81b552f3762bf8427b84701746174d38d0',
    hash: '0e627bf5ef6c459e22c82d7b8214ac39b5f5d66c9dbdaff292781b5ad2e7dff3e9a038939716d87c01e4fd39f4e3429109149209cb5678daabc6829b2e0110d65f6dba575f639b348ff5fc34a31221fff3d1720398c7e352d2f18a0d9b4f21b5375fc5b80a5728700a46e48d82b6509f0e08bbee5b7c73daab86813cee2b24557d2b8e2698578279809dd6bdedc65e797ed77d95cf8a893090673d2967a14584bd3fc4adaf0c092fd1f69d464ab7ce4fbb209dc8f0545158c4e0a3e8b9b87e7fec0413a62b5e6919854a3fec2d853f5269ade5e58425561fc612a0436fe1e2370c8744119d918ced0f421f50dee60376ece7d90c03048b8d6f028890fe990c13c58c41c3d53e19231dda459cf8b29ea41278010e765830299f5ddd9ed73848d314b887f0358401bd219333b19569885b4db79782a7bc36b6d28644eb68259f79d8316b59287f28ad8ae8ffcb396eb92d39ea6ea9a4f6f20e3b4e249f4cd732684319fff5999337c61b4c8c1fb19acfda91fffbb22116d82f3a8e0dc14ef33ff97b5cb572c7d277a1b2e2588728e592e9a3f2698a82f1c342f63f1c282e90daab3705f06069ceb956707c4be6b2f98b609971157ed22f717a9ad4195533003805dc9620f98a8fe20aaaeba002ba507e1d1b15612446474fb638baa927322f50d2d48f54629ca6b2f52434760f3323fb0ea23a20dc3318d26349258d87c7de7da8',
    __v: 0
  }
];

const initDB = async () => {
  // Insert Users
  await User.deleteMany({});
  await User.insertMany(userData);
  console.log("User data inserted");

  // Insert Listings
  await Listing.deleteMany({});
  initData.data = initData.data.map((obj) => ({
    ...obj,
    owner: new mongoose.Types.ObjectId("684580c5cc29a6383d40f5f4")
  }));
  await Listing.insertMany(initData.data);
  console.log("Listing data inserted");

  // Close DB connection
  mongoose.connection.close();
};

initDB();
